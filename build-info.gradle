buildscript {
    repositories {
        jcenter()
    }
    dependencies {
        classpath 'org.ajoberstar:grgit:1.6.0-rc.1'

    }
}
processResources {
    def grgit = org.ajoberstar.grgit.Grgit.open(dir: '.')
    def branch = grgit.branch.getCurrent().getName() + '-' + grgit.head().id
    project.properties['branch'] = branch
    filesMatching('**/bootstrap.yaml') {
        filter(org.apache.tools.ant.filters.ReplaceTokens, tokens: project.properties.findAll { it.value instanceof String }.collectEntries {
            [it.key, it.value]
        })
    }
    outputs.upToDateWhen { false }
}
